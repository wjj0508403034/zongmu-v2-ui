"use strict";angular.module("huoyun.formdata",[]),angular.module("huoyun.formdata").factory("Field",function(){function t(t){this.name=t,this.hasError=!1,this.errorMessage=null,this.value=null,this.validators=[]}return t.prototype.setError=function(t){this.hasError=!0,this.errorMessage=t},t.prototype.clearError=function(){this.hasError=!1,this.errorMessage=null},t.prototype.addValidator=function(t,r,o){this.validators.push(new t(this.name,r,o))},t.prototype.onValid=function(){var t=[];return this.validators.forEach(function(r){t.push(r.onValid(this.value))}.bind(this)),Promise.all(t)},t}),angular.module("huoyun.formdata").factory("FormData",["Field","$q",function(t,r){function o(...r){r.forEach(function(r){this[r]=new t(r)}.bind(this))}return o.prototype.getModel=function(){var t={};return Object.keys(this).forEach(function(r){this.isField(r)&&(t[r]=this[r].value)}.bind(this)),t},o.prototype.setError=function(t,r){this.isField(t)&&this[t].setError(r)},o.prototype.clearErrors=function(){Object.keys(this).forEach(function(t){this.isField(t)&&this[t].clearError()}.bind(this))},o.prototype.isField=function(r){return this[r]instanceof t},o.prototype.addValidator=function(t,r,o,i){this.isField(t)&&this[t].addValidator(r,o,i)},o.prototype.onValid=function(){var t=[];Object.keys(this).forEach(function(r){this.isField(r)&&t.push(this[r].onValid())}.bind(this));var o=r.defer();return Promise.all(t).then(function(){o.resolve()}).catch(function(t){o.reject(t)}),o.promise},o}]),angular.module("huoyun.formdata").factory("Validators",["MandatoryValidator","EmailValidator","StringEqualValidator",function(t,r,o){return{Mandatory:t,Email:r,StringEqual:o}}]),angular.module("huoyun.formdata").factory("EmailValidator",function(){function t(t,r){this.errorMessage=r,this.fieldName=t}const r=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return t.prototype.onValid=function(t){return r.test(t)?Promise.resolve():Promise.reject(this)},t}),angular.module("huoyun.formdata").factory("MandatoryValidator",function(){function t(t,r){this.errorMessage=r,this.fieldName=t}return t.prototype.onValid=function(t){return null===t||void 0===t?Promise.reject(this):"string"==typeof t&&""===t.trim()?Promise.reject(this):Promise.resolve()},t}),angular.module("huoyun.formdata").factory("StringEqualValidator",function(){function t(t,r,o){this.errorMessage=r,this.fieldName=t,this.options=o}return t.prototype.onValid=function(t){if("function"==typeof this.options.equals){let r=this.options.equals.apply(null,[t]);if(r instanceof Promise)return r;if("boolean"==typeof r)return r?Promise.resolve():Promise.reject(this)}throw new Error("StringEqualValidator onValid Error")},t});